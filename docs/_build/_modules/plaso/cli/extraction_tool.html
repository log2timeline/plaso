<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plaso.cli.extraction_tool &mdash; Plaso 1.4.1_20160603 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.4.1_20160603',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="Plaso 1.4.1_20160603 documentation" href="../../../index.html" />
    <link rel="up" title="plaso" href="../../plaso.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../plaso.html" accesskey="U">plaso</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for plaso.cli.extraction_tool</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;The extraction CLI tool.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">argparse</span>

<span class="kn">from</span> <span class="nn">plaso.cli</span> <span class="kn">import</span> <span class="n">storage_media_tool</span>
<span class="kn">from</span> <span class="nn">plaso.engine</span> <span class="kn">import</span> <span class="n">engine</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">definitions</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">py2to3</span>


<div class="viewcode-block" id="ExtractionTool"><a class="viewcode-back" href="../../../plaso.cli.html#plaso.cli.extraction_tool.ExtractionTool">[docs]</a><span class="k">class</span> <span class="nc">ExtractionTool</span><span class="p">(</span><span class="n">storage_media_tool</span><span class="o">.</span><span class="n">StorageMediaTool</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Class that implements an extraction CLI tool.</span>

<span class="sd">  Attributes:</span>
<span class="sd">    list_hashers: boolean value to indicate the hashers should be listed.</span>
<span class="sd">    list_parsers_and_plugins: boolean value to indicate the parsers and</span>
<span class="sd">                              plugins should be listed.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">_DEFAULT_PROFILING_SAMPLE_RATE</span> <span class="o">=</span> <span class="mi">1000</span>

  <span class="c1"># Approximately 250 MB of queued items per worker.</span>
  <span class="n">_DEFAULT_QUEUE_SIZE</span> <span class="o">=</span> <span class="mi">125000</span>

  <span class="c1"># Enable the SHA256 hasher by default.</span>
  <span class="n">_DEFAULT_HASHER_STRING</span> <span class="o">=</span> <span class="s1">u&#39;sha256&#39;</span>

  <span class="n">_BYTES_IN_A_MIB</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_reader</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">output_writer</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the CLI tool object.</span>

<span class="sd">    Args:</span>
<span class="sd">      input_reader: the input reader (instance of InputReader).</span>
<span class="sd">                    The default is None which indicates the use of the stdin</span>
<span class="sd">                    input reader.</span>
<span class="sd">      output_writer: the output writer (instance of OutputWriter).</span>
<span class="sd">                     The default is None which indicates the use of the stdout</span>
<span class="sd">                     output writer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ExtractionTool</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
        <span class="n">input_reader</span><span class="o">=</span><span class="n">input_reader</span><span class="p">,</span> <span class="n">output_writer</span><span class="o">=</span><span class="n">output_writer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enable_profiling</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_filter_object</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hasher_names_string</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_mount_path</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_old_preprocess</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operating_system</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_output_module</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parser_filter_expression</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_process_archive_files</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_profiling_sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_PROFILING_SAMPLE_RATE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_profiling_type</span> <span class="o">=</span> <span class="s1">u&#39;all&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queue_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_QUEUE_SIZE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_single_process_mode</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_storage_serializer_format</span> <span class="o">=</span> <span class="n">definitions</span><span class="o">.</span><span class="n">SERIALIZER_FORMAT_JSON</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_text_prepend</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">list_hashers</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">list_parsers_and_plugins</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">_ParseExtractionOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses the extraction options.</span>

<span class="sd">    Args:</span>
<span class="sd">      options: the command line arguments (instance of argparse.Namespace).</span>

<span class="sd">    Raises:</span>
<span class="sd">      BadConfigOption: if the options are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hasher_names_string</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
        <span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;hashers&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_HASHER_STRING</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hasher_names_string</span><span class="p">,</span> <span class="n">py2to3</span><span class="o">.</span><span class="n">STRING_TYPES</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasher_names_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">u&#39;list&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_hashers</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">parser_filter_expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ParseStringOption</span><span class="p">(</span>
        <span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;parsers&#39;</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="s1">u&#39;&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parser_filter_expression</span> <span class="o">=</span> <span class="n">parser_filter_expression</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s1">u&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">u&#39;/&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parser_filter_expression</span><span class="p">,</span> <span class="n">py2to3</span><span class="o">.</span><span class="n">STRING_TYPES</span><span class="p">)</span> <span class="ow">and</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_filter_expression</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">u&#39;list&#39;</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">list_parsers_and_plugins</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c1"># TODO: preprocess.</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_old_preprocess</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;old_preprocess&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_process_archive_files</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;scan_archives&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_ParsePerformanceOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses the performance options.</span>

<span class="sd">    Args:</span>
<span class="sd">      options: the command line arguments (instance of argparse.Namespace).</span>

<span class="sd">    Raises:</span>
<span class="sd">      BadConfigOption: if the options are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;buffer_size&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">:</span>
      <span class="c1"># TODO: turn this into a generic function that supports more size</span>
      <span class="c1"># suffixes both MB and MiB and also that does not allow m as a valid</span>
      <span class="c1"># indicator for MiB since m represents milli not Mega.</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">u&#39;m&#39;</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BYTES_IN_A_MIB</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
      <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">BadConfigOption</span><span class="p">(</span>
            <span class="s1">u&#39;Invalid buffer size: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">))</span>

    <span class="n">queue_size</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;queue_size&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">queue_size</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">queue_size</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
      <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">BadConfigOption</span><span class="p">(</span>
            <span class="s1">u&#39;Invalid queue size: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">queue_size</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">_ParseProfilingOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses the profiling options.</span>

<span class="sd">    Args:</span>
<span class="sd">      options: the command line arguments (instance of argparse.Namespace).</span>

<span class="sd">    Raises:</span>
<span class="sd">      BadConfigOption: if the options are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enable_profiling</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;enable_profiling&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

    <span class="n">profiling_sample_rate</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;profiling_sample_rate&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">profiling_sample_rate</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_profiling_sample_rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">profiling_sample_rate</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
      <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">BadConfigOption</span><span class="p">(</span>
            <span class="s1">u&#39;Invalid profile sample rate: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">profiling_sample_rate</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_profiling_type</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;profiling_type&#39;</span><span class="p">,</span> <span class="s1">u&#39;all&#39;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_ParseStorageOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses the storage options.</span>

<span class="sd">    Args:</span>
<span class="sd">      options: the command line arguments (instance of argparse.Namespace).</span>

<span class="sd">    Raises:</span>
<span class="sd">      BadConfigOption: if the options are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">serializer_format</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
        <span class="n">options</span><span class="p">,</span> <span class="s1">u&#39;serializer_format&#39;</span><span class="p">,</span> <span class="n">definitions</span><span class="o">.</span><span class="n">SERIALIZER_FORMAT_JSON</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">serializer_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">definitions</span><span class="o">.</span><span class="n">SERIALIZER_FORMATS</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">BadConfigOption</span><span class="p">(</span>
          <span class="s1">u&#39;Unsupported storage serializer format: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
              <span class="n">serializer_format</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_storage_serializer_format</span> <span class="o">=</span> <span class="n">serializer_format</span>

<div class="viewcode-block" id="ExtractionTool.AddExtractionOptions"><a class="viewcode-back" href="../../../plaso.cli.html#plaso.cli.extraction_tool.ExtractionTool.AddExtractionOptions">[docs]</a>  <span class="k">def</span> <span class="nf">AddExtractionOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument_group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds the extraction options to the argument group.</span>

<span class="sd">    Args:</span>
<span class="sd">      argument_group: The argparse argument group (instance of</span>
<span class="sd">                      argparse._ArgumentGroup).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--hashers&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;hashers&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_HASHER_STRING</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">u&#39;HASHER_LIST&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;Define a list of hashers to use by the tool. This is a comma &#39;</span>
            <span class="s1">u&#39;separated list where each entry is the name of a hasher. E.g. &#39;</span>
            <span class="s1">u&#39;&quot;md5,sha256&quot;, &quot;all&quot; to indicate that all hashers should be &#39;</span>
            <span class="s1">u&#39;enabled or &quot;none&quot; to disable all hashers. Use &quot;--hashers list&quot; &#39;</span>
            <span class="s1">u&#39;or &quot;--info&quot; to list the available &#39;</span>
            <span class="s1">u&#39;hashers.&#39;</span><span class="p">))</span>

    <span class="c1"># TODO: rename option name to parser_filter_expression.</span>
    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--parsers&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;parsers&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s1">u&#39;&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">u&#39;PARSER_LIST&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;Define a list of parsers to use by the tool. This is a comma &#39;</span>
            <span class="s1">u&#39;separated list where each entry can be either a name of a parser &#39;</span>
            <span class="s1">u&#39;or a parser list. Each entry can be prepended with a minus sign &#39;</span>
            <span class="s1">u&#39;to negate the selection (exclude it). The list match is an &#39;</span>
            <span class="s1">u&#39;exact match while an individual parser matching is a case &#39;</span>
            <span class="s1">u&#39;insensitive substring match, with support for glob patterns. &#39;</span>
            <span class="s1">u&#39;Examples would be: &quot;reg&quot; that matches the substring &quot;reg&quot; in &#39;</span>
            <span class="s1">u&#39;all parser names or the glob pattern &quot;sky[pd]&quot; that would match &#39;</span>
            <span class="s1">u&#39;all parsers that have the string &quot;skyp&quot; or &quot;skyd&quot; in its name. &#39;</span>
            <span class="s1">u&#39;All matching is case insensitive. Use &quot;--parsers list&quot; or &#39;</span>
            <span class="s1">u&#39;&quot;--info&quot; to list the available parsers.&#39;</span><span class="p">))</span>

    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;-p&#39;</span><span class="p">,</span> <span class="s1">u&#39;--preprocess&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;preprocess&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store_true&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;Turn on preprocessing. Preprocessing is turned on by default &#39;</span>
            <span class="s1">u&#39;when parsing image files, however if a mount point is being &#39;</span>
            <span class="s1">u&#39;parsed then this parameter needs to be set manually.&#39;</span><span class="p">))</span>

    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--scan_archives&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;scan_archives&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store_true&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">)</span>

    <span class="c1"># This option is &quot;hidden&quot; for the time being, still left in there for</span>
    <span class="c1"># testing purposes, but hidden from the tool usage and help messages.</span>
    <span class="c1">#    help=(u&#39;Indicate that the tool should try to open files to extract &#39;</span>
    <span class="c1">#          u&#39;embedded files within them, for instance to extract files &#39;</span>
    <span class="c1">#          u&#39;from compressed containers, etc. Be AWARE THAT THIS IS &#39;</span>
    <span class="c1">#          u&#39;EXTREMELY SLOW.&#39;))</span>

    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">&#39;--use_old_preprocess&#39;</span><span class="p">,</span> <span class="s1">&#39;--use-old-preprocess&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;old_preprocess&#39;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;Only used in conjunction when appending to a previous storage &#39;</span>
            <span class="s1">u&#39;file. When this option is used then a new preprocessing object &#39;</span>
            <span class="s1">u&#39;is not calculated and instead the last one that got added to &#39;</span>
            <span class="s1">u&#39;the storage file is used. This can be handy when parsing an &#39;</span>
            <span class="s1">u&#39;image that contains more than a single partition.&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ExtractionTool.AddPerformanceOptions"><a class="viewcode-back" href="../../../plaso.cli.html#plaso.cli.extraction_tool.ExtractionTool.AddPerformanceOptions">[docs]</a>  <span class="k">def</span> <span class="nf">AddPerformanceOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument_group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds the performance options to the argument group.</span>

<span class="sd">    Args:</span>
<span class="sd">      argument_group: The argparse argument group (instance of</span>
<span class="sd">                      argparse._ArgumentGroup).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--buffer_size&#39;</span><span class="p">,</span> <span class="s1">u&#39;--buffer-size&#39;</span><span class="p">,</span> <span class="s1">u&#39;--bs&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;buffer_size&#39;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">u&#39;The buffer size for the output (defaults to 196MiB).&#39;</span><span class="p">)</span>

    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--queue_size&#39;</span><span class="p">,</span> <span class="s1">u&#39;--queue-size&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;queue_size&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;The maximum number of queued items per worker &#39;</span>
            <span class="s1">u&#39;(defaults to {0:d})&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_QUEUE_SIZE</span><span class="p">))</span></div>

<div class="viewcode-block" id="ExtractionTool.AddProfilingOptions"><a class="viewcode-back" href="../../../plaso.cli.html#plaso.cli.extraction_tool.ExtractionTool.AddProfilingOptions">[docs]</a>  <span class="k">def</span> <span class="nf">AddProfilingOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument_group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds the profiling options to the argument group.</span>

<span class="sd">    Args:</span>
<span class="sd">      argument_group: The argparse argument group (instance of</span>
<span class="sd">                      argparse._ArgumentGroup).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--profile&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;enable_profiling&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store_true&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;Enable profiling. Intended usage is to troubleshoot memory &#39;</span>
            <span class="s1">u&#39;and performance issues.&#39;</span><span class="p">))</span>

    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--profiling_sample_rate&#39;</span><span class="p">,</span> <span class="s1">u&#39;--profiling-sample-rate&#39;</span><span class="p">,</span>
        <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;profiling_sample_rate&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">u&#39;SAMPLE_RATE&#39;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;The profiling sample rate (defaults to a sample every {0:d} &#39;</span>
            <span class="s1">u&#39;files).&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_DEFAULT_PROFILING_SAMPLE_RATE</span><span class="p">))</span>

    <span class="n">profiling_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">u&#39;all&#39;</span><span class="p">,</span> <span class="s1">u&#39;parsers&#39;</span><span class="p">,</span> <span class="s1">u&#39;serializers&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">engine</span><span class="o">.</span><span class="n">BaseEngine</span><span class="o">.</span><span class="n">SupportsMemoryProfiling</span><span class="p">():</span>
      <span class="n">profiling_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;memory&#39;</span><span class="p">)</span>

    <span class="n">argument_group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">u&#39;--profiling_type&#39;</span><span class="p">,</span> <span class="s1">u&#39;--profiling-type&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">u&#39;profiling_type&#39;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">profiling_types</span><span class="p">),</span> <span class="n">action</span><span class="o">=</span><span class="s1">u&#39;store&#39;</span><span class="p">,</span>
        <span class="n">metavar</span><span class="o">=</span><span class="s1">u&#39;TYPE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s1">u&#39;The profiling type: &quot;all&quot;, &quot;memory&quot;, &quot;parsers&quot; or &#39;</span>
            <span class="s1">u&#39;&quot;serializers&quot;.&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ExtractionTool.ParseOptions"><a class="viewcode-back" href="../../../plaso.cli.html#plaso.cli.extraction_tool.ExtractionTool.ParseOptions">[docs]</a>  <span class="k">def</span> <span class="nf">ParseOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses tool specific options.</span>

<span class="sd">    Args:</span>
<span class="sd">      options: the command line arguments (instance of argparse.Namespace).</span>

<span class="sd">    Raises:</span>
<span class="sd">      BadConfigOption: if the options are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ExtractionTool</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">ParseOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ParseDataLocationOption</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ParseFilterOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ParsePerformanceOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ParseProfilingOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ParseStorageOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../plaso.html" >plaso</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright The Plaso Project Authors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.2.
    </div>
  </body>
</html>