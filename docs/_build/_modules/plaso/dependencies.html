<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plaso.dependencies &mdash; Plaso 1.4.1_20160603 documentation</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.4.1_20160603',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Plaso 1.4.1_20160603 documentation" href="../../index.html" />
    <link rel="up" title="plaso" href="../plaso.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../plaso.html" accesskey="U">plaso</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for plaso.dependencies</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Functionality to check for the availability and version of dependencies.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># pylint: disable=import-error</span>
<span class="c1"># pylint: disable=no-name-in-module</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
  <span class="c1"># Keep urllib2 here since we this code should be able to be used</span>
  <span class="c1"># by a default Python set up.</span>
  <span class="kn">import</span> <span class="nn">urllib2</span> <span class="kn">as</span> <span class="nn">urllib_error</span>
  <span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="k">else</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">urllib.error</span> <span class="kn">as</span> <span class="nn">urllib_error</span>
  <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>


<span class="c1"># The dictionary values are:</span>
<span class="c1"># module_name: minimum_version</span>
<span class="n">LIBYAL_DEPENDENCIES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">u&#39;pybde&#39;</span><span class="p">:</span> <span class="mi">20140531</span><span class="p">,</span>
    <span class="s1">u&#39;pyesedb&#39;</span><span class="p">:</span> <span class="mi">20150409</span><span class="p">,</span>
    <span class="s1">u&#39;pyevt&#39;</span><span class="p">:</span> <span class="mi">20120410</span><span class="p">,</span>
    <span class="s1">u&#39;pyevtx&#39;</span><span class="p">:</span> <span class="mi">20141112</span><span class="p">,</span>
    <span class="s1">u&#39;pyewf&#39;</span><span class="p">:</span> <span class="mi">20131210</span><span class="p">,</span>
    <span class="s1">u&#39;pyfsntfs&#39;</span><span class="p">:</span> <span class="mi">20151130</span><span class="p">,</span>
    <span class="s1">u&#39;pyfwsi&#39;</span><span class="p">:</span> <span class="mi">20150606</span><span class="p">,</span>
    <span class="s1">u&#39;pylnk&#39;</span><span class="p">:</span> <span class="mi">20150830</span><span class="p">,</span>
    <span class="s1">u&#39;pymsiecf&#39;</span><span class="p">:</span> <span class="mi">20150314</span><span class="p">,</span>
    <span class="s1">u&#39;pyolecf&#39;</span><span class="p">:</span> <span class="mi">20151223</span><span class="p">,</span>
    <span class="s1">u&#39;pyqcow&#39;</span><span class="p">:</span> <span class="mi">20131204</span><span class="p">,</span>
    <span class="s1">u&#39;pyregf&#39;</span><span class="p">:</span> <span class="mi">20150315</span><span class="p">,</span>
    <span class="s1">u&#39;pyscca&#39;</span><span class="p">:</span> <span class="mi">20151226</span><span class="p">,</span>
    <span class="s1">u&#39;pysigscan&#39;</span><span class="p">:</span> <span class="mi">20150627</span><span class="p">,</span>
    <span class="s1">u&#39;pysmdev&#39;</span><span class="p">:</span> <span class="mi">20140529</span><span class="p">,</span>
    <span class="s1">u&#39;pysmraw&#39;</span><span class="p">:</span> <span class="mi">20140612</span><span class="p">,</span>
    <span class="s1">u&#39;pyvhdi&#39;</span><span class="p">:</span> <span class="mi">20131210</span><span class="p">,</span>
    <span class="s1">u&#39;pyvmdk&#39;</span><span class="p">:</span> <span class="mi">20140421</span><span class="p">,</span>
    <span class="s1">u&#39;pyvshadow&#39;</span><span class="p">:</span> <span class="mi">20160109</span><span class="p">}</span>

<span class="c1"># The tuple values are:</span>
<span class="c1"># module_name, version_attribute_name, minimum_version, maximum_version</span>
<span class="n">PYTHON_DEPENDENCIES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">u&#39;artifacts&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;20150409&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="c1"># The bencode module does not appear to have version information.</span>
    <span class="p">(</span><span class="s1">u&#39;bencode&#39;</span><span class="p">,</span> <span class="s1">u&#39;&#39;</span><span class="p">,</span> <span class="s1">u&#39;&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;binplist&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;0.1.4&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;construct&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;2.5.2&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;dateutil&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.5&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;dfdatetime&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;20160319&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;dfvfs&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;20160510&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;dfwinreg&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;20160320&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;dpkt&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.8&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;hachoir_core&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.3.3&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;hachoir_parser&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.3.4&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;hachoir_metadata&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.3.3&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;IPython&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.2.1&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;pefile&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.2.10-139&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;psutil&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.2.1&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;pyparsing&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;2.0.3&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="c1"># TODO: determine the version of pytz.</span>
    <span class="c1"># pytz uses __version__ but has a different version indicator e.g. 2012d</span>
    <span class="p">(</span><span class="s1">u&#39;pytz&#39;</span><span class="p">,</span> <span class="s1">u&#39;&#39;</span><span class="p">,</span> <span class="s1">u&#39;&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;requests&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;2.2.1&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;six&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;1.1.0&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;xlsxwriter&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;0.6.5&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;yaml&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;3.10&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">u&#39;zmq&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;2.1.11&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>

<span class="c1"># The tuple values are:</span>
<span class="c1"># module_name, version_attribute_name, minimum_version, maximum_version</span>
<span class="n">PYTHON_TEST_DEPENDENCIES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">u&#39;mock&#39;</span><span class="p">,</span> <span class="s1">u&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">u&#39;0.7.1&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>

<span class="n">_VERSION_SPLIT_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;\.|\-&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_DownloadPageContent</span><span class="p">(</span><span class="n">download_url</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Downloads the page content.</span>

<span class="sd">  Args:</span>
<span class="sd">    download_url: the URL where to download the page content.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The page content if successful, None otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">download_url</span><span class="p">:</span>
    <span class="k">return</span>

  <span class="n">url_object</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">url_object</span> <span class="ow">or</span> <span class="n">url_object</span><span class="o">.</span><span class="n">code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
    <span class="k">return</span>

  <span class="k">return</span> <span class="n">url_object</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_ImportPythonModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Imports a Python module.</span>

<span class="sd">  Args:</span>
<span class="sd">    module_name: the name of the module.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The Python module object (instance of module) or None</span>
<span class="sd">    if the module cannot be imported.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">module_object</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">__import__</span><span class="p">,</span> <span class="p">[</span><span class="n">module_name</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">return</span>

  <span class="c1"># If the module name contains dots get the upper most module object.</span>
  <span class="k">if</span> <span class="s1">u&#39;.&#39;</span> <span class="ow">in</span> <span class="n">module_name</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">submodule_name</span> <span class="ow">in</span> <span class="n">module_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">u&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]:</span>
      <span class="n">module_object</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module_object</span><span class="p">,</span> <span class="n">submodule_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">module_object</span>


<span class="k">def</span> <span class="nf">_GetLibyalGithubReleasesLatestVersion</span><span class="p">(</span><span class="n">library_name</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Retrieves the latest version number of a libyal library on GitHub releases.</span>

<span class="sd">  Args:</span>
<span class="sd">    library_name: the name of the libyal library.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The latest version for a given libyal library on GitHub releases</span>
<span class="sd">    or 0 on error.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">download_url</span> <span class="o">=</span> <span class="p">(</span>
      <span class="s1">u&#39;https://github.com/libyal/{0:s}/releases&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">library_name</span><span class="p">)</span>

  <span class="n">page_content</span> <span class="o">=</span> <span class="n">_DownloadPageContent</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">page_content</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span>

  <span class="c1"># The format of the project download URL is:</span>
  <span class="c1"># /libyal/{project name}/releases/download/{git tag}/</span>
  <span class="c1"># {project name}{status-}{version}.tar.gz</span>
  <span class="c1"># Note that the status is optional and will be: beta, alpha or experimental.</span>
  <span class="n">expression_string</span> <span class="o">=</span> <span class="p">(</span>
      <span class="s1">u&#39;/libyal/{0:s}/releases/download/[^/]*/{0:s}-[a-z-]*([0-9]+)&#39;</span>
      <span class="s1">u&#39;[.]tar[.]gz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">library_name</span><span class="p">)</span>
  <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">expression_string</span><span class="p">,</span> <span class="n">page_content</span><span class="p">)</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span>

  <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">matches</span><span class="p">))</span>


<span class="c1"># TODO: Remove when Google Drive support is no longer needed.</span>
<span class="k">def</span> <span class="nf">_GetLibyalGoogleDriveLatestVersion</span><span class="p">(</span><span class="n">library_name</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Retrieves the latest version number of a libyal library on Google Drive.</span>

<span class="sd">  Args:</span>
<span class="sd">    library_name: the name of the libyal library.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The latest version for a given libyal library on Google Drive</span>
<span class="sd">    or 0 on error.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">download_url</span> <span class="o">=</span> <span class="s1">u&#39;https://code.google.com/p/{0:s}/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">library_name</span><span class="p">)</span>

  <span class="n">page_content</span> <span class="o">=</span> <span class="n">_DownloadPageContent</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">page_content</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span>

  <span class="c1"># The format of the library downloads URL is:</span>
  <span class="c1"># https://googledrive.com/host/{random string}/</span>
  <span class="n">expression_string</span> <span class="o">=</span> <span class="p">(</span>
      <span class="n">b</span><span class="s1">&#39;&lt;a href=&quot;(https://googledrive.com/host/[^/]*/)&quot;[^&gt;]*&gt;Downloads&lt;/a&gt;&#39;</span><span class="p">)</span>
  <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">expression_string</span><span class="p">,</span> <span class="n">page_content</span><span class="p">)</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span>

  <span class="n">page_content</span> <span class="o">=</span> <span class="n">_DownloadPageContent</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">page_content</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span>

  <span class="c1"># The format of the library download URL is:</span>
  <span class="c1"># /host/{random string}/{library name}-{status-}{version}.tar.gz</span>
  <span class="c1"># Note that the status is optional and will be: beta, alpha or experimental.</span>
  <span class="n">expression_string</span> <span class="o">=</span> <span class="n">b</span><span class="s1">&#39;/host/[^/]*/{0:s}-[a-z-]*([0-9]+)[.]tar[.]gz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">library_name</span><span class="p">)</span>
  <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">expression_string</span><span class="p">,</span> <span class="n">page_content</span><span class="p">)</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">0</span>

  <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">matches</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_CheckLibyal</span><span class="p">(</span>
    <span class="n">libyal_python_modules</span><span class="p">,</span> <span class="n">latest_version_check</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose_output</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the availability of libyal libraries.</span>

<span class="sd">  Args:</span>
<span class="sd">    libyal_python_modules: a dictionary of libyal python module name as</span>
<span class="sd">                           the key and version as the value.</span>
<span class="sd">    latest_version_check: optional boolean value to indicate if the project</span>
<span class="sd">                          site should be checked for the latest version.</span>
<span class="sd">    verbose_output: optional boolean to indicate output should be verbose.</span>

<span class="sd">  Returns:</span>
<span class="sd">    True if the libyal libraries are available, False otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">connection_error</span> <span class="o">=</span> <span class="bp">False</span>
  <span class="n">result</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="k">for</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">libyal_python_modules</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">module_object</span> <span class="o">=</span> <span class="n">_ImportPythonModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">module_object</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">missing: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
      <span class="n">result</span> <span class="o">=</span> <span class="bp">False</span>
      <span class="k">continue</span>

    <span class="n">libyal_name</span> <span class="o">=</span> <span class="s1">u&#39;lib{0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

    <span class="n">installed_version</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">module_object</span><span class="o">.</span><span class="n">get_version</span><span class="p">())</span>

    <span class="n">latest_version</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">latest_version_check</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">latest_version</span> <span class="o">=</span> <span class="n">_GetLibyalGithubReleasesLatestVersion</span><span class="p">(</span><span class="n">libyal_name</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">urllib_error</span><span class="o">.</span><span class="n">URLError</span><span class="p">:</span>
        <span class="n">latest_version</span> <span class="o">=</span> <span class="bp">None</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">latest_version</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">latest_version</span> <span class="o">=</span> <span class="n">_GetLibyalGoogleDriveLatestVersion</span><span class="p">(</span><span class="n">libyal_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">urllib_error</span><span class="o">.</span><span class="n">URLError</span><span class="p">:</span>
          <span class="n">latest_version</span> <span class="o">=</span> <span class="bp">None</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">latest_version</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span>
            <span class="s1">u&#39;Unable to determine latest version of {0:s} ({1:s}).</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">libyal_name</span><span class="p">,</span> <span class="n">module_name</span><span class="p">))</span>
        <span class="n">latest_version</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">connection_error</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">module_version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">installed_version</span> <span class="o">&lt;</span> <span class="n">module_version</span><span class="p">:</span>
      <span class="k">print</span><span class="p">((</span>
          <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">{0:s} ({1:s}) version: {2:d} is too old, {3:d} or &#39;</span>
          <span class="s1">u&#39;later required.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
              <span class="n">libyal_name</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">installed_version</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span>
      <span class="n">result</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">elif</span> <span class="n">verbose_output</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">latest_version</span> <span class="ow">and</span> <span class="n">installed_version</span> <span class="o">!=</span> <span class="n">latest_version</span><span class="p">:</span>
        <span class="k">print</span><span class="p">((</span>
            <span class="s1">u&#39;[INFO]</span><span class="se">\t\t</span><span class="s1">{0:s} ({1:s}) version: {2:d} installed, &#39;</span>
            <span class="s1">u&#39;version: {3:d} available.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">libyal_name</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">installed_version</span><span class="p">,</span> <span class="n">latest_version</span><span class="p">))</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]</span><span class="se">\t\t</span><span class="s1">{0:s} ({1:s}) version: {2:d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">libyal_name</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">installed_version</span><span class="p">))</span>

  <span class="k">if</span> <span class="n">connection_error</span><span class="p">:</span>
    <span class="k">print</span><span class="p">((</span>
        <span class="s1">u&#39;[INFO] to check for the latest versions this script needs Internet &#39;</span>
        <span class="s1">u&#39;access.&#39;</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_CheckPythonModule</span><span class="p">(</span>
    <span class="n">module_name</span><span class="p">,</span> <span class="n">version_attribute_name</span><span class="p">,</span> <span class="n">minimum_version</span><span class="p">,</span>
    <span class="n">maximum_version</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verbose_output</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the availability of a Python module.</span>

<span class="sd">  Args:</span>
<span class="sd">    module_name: the name of the module.</span>
<span class="sd">    version_attribute_name: the name of the attribute that contains the module</span>
<span class="sd">                            version.</span>
<span class="sd">    minimum_version: the minimum required version.</span>
<span class="sd">    maximum_version: the maximum required version. This attribute is optional</span>
<span class="sd">                     and should only be used if there is a recent API change</span>
<span class="sd">                     that prevents the tool from running if a later version</span>
<span class="sd">                     is used.</span>
<span class="sd">    verbose_output: optional boolean to indicate output should be verbose.</span>

<span class="sd">  Returns:</span>
<span class="sd">    True if the Python module is available and conforms to the minimum required</span>
<span class="sd">    version. False otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">module_object</span> <span class="o">=</span> <span class="n">_ImportPythonModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">module_object</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">missing: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">version_attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">minimum_version</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">verbose_output</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]</span><span class="se">\t\t</span><span class="s1">{0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">True</span>

  <span class="n">module_version</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module_object</span><span class="p">,</span> <span class="n">version_attribute_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">module_version</span><span class="p">:</span>
    <span class="k">print</span><span class="p">((</span>
        <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">unable to determine version information &#39;</span>
        <span class="s1">u&#39;for: {0:s}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="c1"># Split the version string and convert every digit into an integer.</span>
  <span class="c1"># A string compare of both version strings will yield an incorrect result.</span>
  <span class="n">module_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
      <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">_VERSION_SPLIT_REGEX</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">module_version</span><span class="p">)))</span>
  <span class="n">minimum_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
      <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">_VERSION_SPLIT_REGEX</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">minimum_version</span><span class="p">)))</span>

  <span class="k">if</span> <span class="n">module_version_map</span> <span class="o">&lt;</span> <span class="n">minimum_version_map</span><span class="p">:</span>
    <span class="k">print</span><span class="p">((</span>
        <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">{0:s} version: {1:s} is too old, {2:s} or later &#39;</span>
        <span class="s1">u&#39;required.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">,</span> <span class="n">minimum_version</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="n">maximum_version</span><span class="p">:</span>
    <span class="n">maximum_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">_VERSION_SPLIT_REGEX</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">maximum_version</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">module_version_map</span> <span class="o">&gt;</span> <span class="n">maximum_version_map</span><span class="p">:</span>
      <span class="k">print</span><span class="p">((</span>
          <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">{0:s} version: {1:s} is too recent, {2:s} or earlier &#39;</span>
          <span class="s1">u&#39;required.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">,</span> <span class="n">maximum_version</span><span class="p">))</span>
      <span class="k">return</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="n">verbose_output</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]</span><span class="se">\t\t</span><span class="s1">{0:s} version: {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span>

  <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">_CheckPytsk</span><span class="p">(</span><span class="n">verbose_output</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the availability of pytsk.</span>

<span class="sd">  Args:</span>
<span class="sd">    verbose_output: optional boolean to indicate output should be verbose.</span>

<span class="sd">  Returns:</span>
<span class="sd">    True if the pytsk Python module is available, False otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">module_name</span> <span class="o">=</span> <span class="s1">u&#39;pytsk3&#39;</span>
  <span class="n">minimum_version_libtsk</span> <span class="o">=</span> <span class="s1">u&#39;4.1.2&#39;</span>
  <span class="n">minimum_version_pytsk</span> <span class="o">=</span> <span class="s1">u&#39;20140506&#39;</span>

  <span class="n">module_object</span> <span class="o">=</span> <span class="n">_ImportPythonModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">module_object</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">missing: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="n">module_version</span> <span class="o">=</span> <span class="n">module_object</span><span class="o">.</span><span class="n">TSK_VERSION_STR</span>

  <span class="c1"># Split the version string and convert every digit into an integer.</span>
  <span class="c1"># A string compare of both version strings will yield an incorrect result.</span>
  <span class="n">module_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">module_version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">u&#39;.&#39;</span><span class="p">)))</span>
  <span class="n">minimum_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">minimum_version_libtsk</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">u&#39;.&#39;</span><span class="p">)))</span>
  <span class="k">if</span> <span class="n">module_version_map</span> <span class="o">&lt;</span> <span class="n">minimum_version_map</span><span class="p">:</span>
    <span class="k">print</span><span class="p">((</span>
        <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">SleuthKit (libtsk) version: {0:s} is too old, {1:s} or &#39;</span>
        <span class="s1">u&#39;later required.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_version</span><span class="p">,</span> <span class="n">minimum_version_libtsk</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="n">verbose_output</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]</span><span class="se">\t\t</span><span class="s1">SleuthKit version: {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_version</span><span class="p">))</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module_object</span><span class="p">,</span> <span class="s1">u&#39;get_version&#39;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">{0:s} is too old, {1:s} or later required.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">module_name</span><span class="p">,</span> <span class="n">minimum_version_pytsk</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="n">module_version</span> <span class="o">=</span> <span class="n">module_object</span><span class="o">.</span><span class="n">get_version</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">module_version</span> <span class="o">&lt;</span> <span class="n">minimum_version_pytsk</span><span class="p">:</span>
    <span class="k">print</span><span class="p">((</span>
        <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">{0:s} version: {1:s} is too old, {2:s} or later &#39;</span>
        <span class="s1">u&#39;required.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">,</span> <span class="n">minimum_version_pytsk</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="n">verbose_output</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]</span><span class="se">\t\t</span><span class="s1">{0:s} version: {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span>

  <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">_CheckSqlite3</span><span class="p">(</span><span class="n">verbose_output</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the availability of sqlite3.</span>

<span class="sd">  Args:</span>
<span class="sd">    verbose_output: optional boolean to indicate output should be verbose.</span>

<span class="sd">  Returns:</span>
<span class="sd">    True if the sqlite3 Python module is available, False otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1"># On Windows sqlite3 can be provided by both pysqlite2.dbapi2 and</span>
  <span class="c1"># sqlite3. sqlite3 is provided with the Python installation and</span>
  <span class="c1"># pysqlite2.dbapi2 by the pysqlite2 Python module. Typically</span>
  <span class="c1"># pysqlite2.dbapi2 would contain a newer version of sqlite3, hence</span>
  <span class="c1"># we check for its presence first.</span>
  <span class="n">module_name</span> <span class="o">=</span> <span class="s1">u&#39;pysqlite2.dbapi2&#39;</span>
  <span class="n">minimum_version</span> <span class="o">=</span> <span class="s1">u&#39;3.7.8&#39;</span>

  <span class="n">module_object</span> <span class="o">=</span> <span class="n">_ImportPythonModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">module_object</span><span class="p">:</span>
    <span class="n">module_name</span> <span class="o">=</span> <span class="s1">u&#39;sqlite3&#39;</span>

  <span class="n">module_object</span> <span class="o">=</span> <span class="n">_ImportPythonModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">module_object</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">missing: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="n">module_version</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module_object</span><span class="p">,</span> <span class="s1">u&#39;sqlite_version&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">module_version</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="c1"># Split the version string and convert every digit into an integer.</span>
  <span class="c1"># A string compare of both version strings will yield an incorrect result.</span>
  <span class="n">module_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
      <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">_VERSION_SPLIT_REGEX</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">module_version</span><span class="p">)))</span>
  <span class="n">minimum_version_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
      <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">_VERSION_SPLIT_REGEX</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">minimum_version</span><span class="p">)))</span>

  <span class="k">if</span> <span class="n">module_version_map</span> <span class="o">&lt;</span> <span class="n">minimum_version_map</span><span class="p">:</span>
    <span class="k">print</span><span class="p">((</span>
        <span class="s1">u&#39;[FAILURE]</span><span class="se">\t</span><span class="s1">{0:s} version: {1:s} is too old, {2:s} or later &#39;</span>
        <span class="s1">u&#39;required.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">,</span> <span class="n">minimum_version</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="n">verbose_output</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]</span><span class="se">\t\t</span><span class="s1">{0:s} version: {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span>

  <span class="k">return</span> <span class="bp">True</span>


<div class="viewcode-block" id="CheckDependencies"><a class="viewcode-back" href="../../plaso.html#plaso.dependencies.CheckDependencies">[docs]</a><span class="k">def</span> <span class="nf">CheckDependencies</span><span class="p">(</span><span class="n">latest_version_check</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose_output</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the availability of the dependencies.</span>

<span class="sd">  Args:</span>
<span class="sd">    latest_version_check: optional boolean value to indicate if the project</span>
<span class="sd">                          site should be checked for the latest version.</span>
<span class="sd">    verbose_output: optional boolean to indicate output should be verbose.</span>

<span class="sd">  Returns:</span>
<span class="sd">    True if the dependencies are available, False otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;Checking availability and versions of plaso dependencies.&#39;</span><span class="p">)</span>
  <span class="n">check_result</span> <span class="o">=</span> <span class="bp">True</span>

  <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">PYTHON_DEPENDENCIES</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_CheckPythonModule</span><span class="p">(</span>
        <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">maximum_version</span><span class="o">=</span><span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">verbose_output</span><span class="o">=</span><span class="n">verbose_output</span><span class="p">):</span>
      <span class="n">check_result</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">_CheckSqlite3</span><span class="p">(</span><span class="n">verbose_output</span><span class="o">=</span><span class="n">verbose_output</span><span class="p">):</span>
    <span class="n">check_result</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">_CheckPytsk</span><span class="p">(</span><span class="n">verbose_output</span><span class="o">=</span><span class="n">verbose_output</span><span class="p">):</span>
    <span class="n">check_result</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="n">libyal_check_result</span> <span class="o">=</span> <span class="n">_CheckLibyal</span><span class="p">(</span>
      <span class="n">LIBYAL_DEPENDENCIES</span><span class="p">,</span> <span class="n">latest_version_check</span><span class="o">=</span><span class="n">latest_version_check</span><span class="p">,</span>
      <span class="n">verbose_output</span><span class="o">=</span><span class="n">verbose_output</span><span class="p">)</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">libyal_check_result</span><span class="p">:</span>
    <span class="n">check_result</span> <span class="o">=</span> <span class="bp">False</span>

  <span class="k">if</span> <span class="n">check_result</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">verbose_output</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;[OK]&#39;</span><span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;&#39;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">check_result</span></div>


<div class="viewcode-block" id="CheckModuleVersion"><a class="viewcode-back" href="../../plaso.html#plaso.dependencies.CheckModuleVersion">[docs]</a><span class="k">def</span> <span class="nf">CheckModuleVersion</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the version requirements of a module.</span>

<span class="sd">  Args:</span>
<span class="sd">    module_name: the name of the module.</span>

<span class="sd">  Raises:</span>
<span class="sd">    ImportError: if the module does not exists or does not meet</span>
<span class="sd">                 the version requirements.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1"># TODO: add support for non libyal dependencies.</span>
  <span class="k">if</span> <span class="n">module_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LIBYAL_DEPENDENCIES</span><span class="p">:</span>
    <span class="k">return</span>

  <span class="k">try</span><span class="p">:</span>
    <span class="n">module_object</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">__import__</span><span class="p">,</span> <span class="p">[</span><span class="n">module_name</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">raise</span>

  <span class="n">module_version</span> <span class="o">=</span> <span class="n">module_object</span><span class="o">.</span><span class="n">get_version</span><span class="p">()</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">module_version</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">module_version</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">u&#39;Unable to determine version of module {0:s}&#39;</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">module_version</span> <span class="o">&lt;</span> <span class="n">LIBYAL_DEPENDENCIES</span><span class="p">[</span><span class="n">module_name</span><span class="p">]:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
        <span class="s1">u&#39;Module {0:s} is too old, minimum required version {1!s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span></div>


<div class="viewcode-block" id="CheckTestDependencies"><a class="viewcode-back" href="../../plaso.html#plaso.dependencies.CheckTestDependencies">[docs]</a><span class="k">def</span> <span class="nf">CheckTestDependencies</span><span class="p">(</span><span class="n">latest_version_check</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Checks the availability of the dependencies when running tests.</span>

<span class="sd">  Args:</span>
<span class="sd">    latest_version_check: optional boolean value to indicate if the project</span>
<span class="sd">                          site should be checked for the latest version.</span>

<span class="sd">  Returns:</span>
<span class="sd">    True if the dependencies are available, False otherwise.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">CheckDependencies</span><span class="p">(</span><span class="n">latest_version_check</span><span class="o">=</span><span class="n">latest_version_check</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">print</span><span class="p">(</span><span class="s1">u&#39;Checking availability and versions of plaso test dependencies.&#39;</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">PYTHON_TEST_DEPENDENCIES</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_CheckPythonModule</span><span class="p">(</span>
        <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">maximum_version</span><span class="o">=</span><span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
      <span class="k">return</span> <span class="bp">False</span>

  <span class="k">return</span> <span class="bp">True</span></div>


<div class="viewcode-block" id="GetInstallRequires"><a class="viewcode-back" href="../../plaso.html#plaso.dependencies.GetInstallRequires">[docs]</a><span class="k">def</span> <span class="nf">GetInstallRequires</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;Returns the install_requires for setup.py&quot;&quot;&quot;</span>
  <span class="n">install_requires</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">PYTHON_DEPENDENCIES</span><span class="p">:</span>
    <span class="n">module_name</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">module_version</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Map the import name to the pypi name.</span>
    <span class="k">if</span> <span class="n">module_name</span> <span class="o">==</span> <span class="s1">u&#39;yaml&#39;</span><span class="p">:</span>
      <span class="n">module_name</span> <span class="o">=</span> <span class="s1">u&#39;PyYAML&#39;</span>
    <span class="k">elif</span> <span class="n">module_name</span> <span class="o">==</span> <span class="s1">u&#39;sqlite3&#39;</span><span class="p">:</span>
      <span class="c1"># Override the pysqlite version since it does not match</span>
      <span class="c1"># the sqlite3 version.</span>
      <span class="n">module_name</span> <span class="o">=</span> <span class="s1">u&#39;pysqlite&#39;</span>
      <span class="n">module_version</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">module_version</span><span class="p">:</span>
      <span class="n">install_requires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">install_requires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;{0:s} &gt;= {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span>

  <span class="n">install_requires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;pytsk3 &gt;= 4.1.2&#39;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">LIBYAL_DEPENDENCIES</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">module_version</span><span class="p">:</span>
      <span class="n">install_requires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">install_requires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;{0:s} &gt;= {1:d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">module_name</span><span class="p">,</span> <span class="n">module_version</span><span class="p">))</span>

  <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">install_requires</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../plaso.html" >plaso</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright The Plaso Project Authors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.2.
    </div>
  </body>
</html>