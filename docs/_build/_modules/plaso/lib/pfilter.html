<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plaso.lib.pfilter &mdash; Plaso 1.4.1_20160603 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.4.1_20160603',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="Plaso 1.4.1_20160603 documentation" href="../../../index.html" />
    <link rel="up" title="plaso" href="../../plaso.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../plaso.html" accesskey="U">plaso</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for plaso.lib.pfilter</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;An extension of the objectfilter to provide plaso specific options.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">plaso.formatters</span> <span class="kn">import</span> <span class="n">manager</span> <span class="k">as</span> <span class="n">formatters_manager</span>
<span class="kn">from</span> <span class="nn">plaso.formatters</span> <span class="kn">import</span> <span class="n">mediator</span> <span class="k">as</span> <span class="n">formatters_mediator</span>

<span class="c1"># TODO: Changes this so it becomes an attribute instead of having backend</span>
<span class="c1"># load a front-end library.</span>
<span class="kn">from</span> <span class="nn">plaso.frontend</span> <span class="kn">import</span> <span class="n">presets</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">objectfilter</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">py2to3</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">timelib</span>
<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">utils</span>


<div class="viewcode-block" id="DictObject"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DictObject">[docs]</a><span class="k">class</span> <span class="nc">DictObject</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="c1"># There&#39;s a backslash in the class docstring, so as not to confuse Sphinx.</span>
  <span class="c1"># pylint: disable=anomalous-backslash-in-string</span>
  <span class="sd">&quot;&quot;&quot;A simple object representing a dict object.</span>

<span class="sd">  To filter against an object that is stored as a dictionary the dict</span>
<span class="sd">  is converted into a simple object. Since keys can contain spaces</span>
<span class="sd">  and/or other symbols they are stripped out to make filtering work</span>
<span class="sd">  like it is another object.</span>

<span class="sd">  Example dict::</span>

<span class="sd">    {&#39;A value&#39;: 234,</span>
<span class="sd">     &#39;this (my) key_&#39;: &#39;value&#39;,</span>
<span class="sd">     &#39;random&#39;: True,</span>
<span class="sd">    }</span>

<span class="sd">  This object would then allow access to object.thismykey that would access</span>
<span class="sd">  the key &#39;this (my) key\_&#39; inside the dict.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the object and build a secondary dict.&quot;&quot;&quot;</span>
    <span class="c1"># TODO: Move some of this code to a more value typed system.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_object</span> <span class="o">=</span> <span class="n">dict_object</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_translated</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_object</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_dict_translated</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_StripKey</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>

  <span class="k">def</span> <span class="nf">_StripKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a stripped version of the dict key without symbols.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39; (){}+_=-&lt;&gt;[]&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
      <span class="k">pass</span>

<div class="viewcode-block" id="DictObject.__getattr__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DictObject.__getattr__">[docs]</a>  <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return back entries from the dictionary.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_object</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_object</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

    <span class="c1"># Special case of getting all the key/value pairs.</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;__all__&#39;</span><span class="p">:</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_translated</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;{}:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
      <span class="k">return</span> <span class="s1">u&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_StripKey</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">test</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_translated</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_translated</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">test</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PlasoValueExpander"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.PlasoValueExpander">[docs]</a><span class="k">class</span> <span class="nc">PlasoValueExpander</span><span class="p">(</span><span class="n">objectfilter</span><span class="o">.</span><span class="n">AttributeValueExpander</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;An expander that gives values based on object attribute names.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize an attribute value expander.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">PlasoValueExpander</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">_GetMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a properly formatted message string.</span>

<span class="sd">    Args:</span>
<span class="sd">      event_object: the event object (instance od EventObject).</span>

<span class="sd">    Returns:</span>
<span class="sd">      A formatted message string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: move this somewhere where the mediator can be instantiated once.</span>
    <span class="n">formatter_mediator</span> <span class="o">=</span> <span class="n">formatters_mediator</span><span class="o">.</span><span class="n">FormatterMediator</span><span class="p">()</span>

    <span class="n">result</span> <span class="o">=</span> <span class="s1">u&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">result</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">formatters_manager</span><span class="o">.</span><span class="n">FormattersManager</span><span class="o">.</span><span class="n">GetMessageStrings</span><span class="p">(</span>
          <span class="n">formatter_mediator</span><span class="p">,</span> <span class="n">event_object</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
      <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">u&#39;Unable to correctly assemble event: {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">exception</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span>

  <span class="k">def</span> <span class="nf">_GetSources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns properly formatted source strings.</span>

<span class="sd">    Args:</span>
<span class="sd">      event_object: the event object (instance od EventObject).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">source_short</span><span class="p">,</span> <span class="n">source_long</span> <span class="o">=</span> <span class="p">(</span>
          <span class="n">formatters_manager</span><span class="o">.</span><span class="n">FormattersManager</span><span class="o">.</span><span class="n">GetSourceStrings</span><span class="p">(</span><span class="n">event_object</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
      <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">u&#39;Unable to correctly assemble event: {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">exception</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">source_short</span><span class="p">,</span> <span class="n">source_long</span>

  <span class="k">def</span> <span class="nf">_GetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">DictObject</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">attr_name</span> <span class="o">==</span> <span class="s1">&#39;tag&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ret</span><span class="o">.</span><span class="n">tags</span>

      <span class="k">return</span> <span class="n">ret</span>

    <span class="c1"># Check if this is a message request and we have a regular EventObject.</span>
    <span class="k">if</span> <span class="n">attr_name</span> <span class="o">==</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetMessage</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="c1"># Check if this is a source_short request.</span>
    <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;source_short&#39;</span><span class="p">):</span>
      <span class="n">source_short</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetSources</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">source_short</span>

    <span class="c1"># Check if this is a source_long request.</span>
    <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;source_long&#39;</span><span class="p">,</span> <span class="s1">&#39;sourcetype&#39;</span><span class="p">):</span>
      <span class="n">_</span><span class="p">,</span> <span class="n">source_long</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetSources</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">source_long</span>

  <span class="k">def</span> <span class="nf">_GetAttributeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>


<div class="viewcode-block" id="PlasoExpression"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.PlasoExpression">[docs]</a><span class="k">class</span> <span class="nc">PlasoExpression</span><span class="p">(</span><span class="n">objectfilter</span><span class="o">.</span><span class="n">BasicExpression</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A Plaso specific expression.&quot;&quot;&quot;</span>
  <span class="c1"># A simple dictionary used to swap attributes so other names can be used</span>
  <span class="c1"># to reference some core attributes (implementation specific).</span>
  <span class="n">swap_source</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
      <span class="s1">&#39;datetime&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
      <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
      <span class="s1">&#39;description_long&#39;</span><span class="p">:</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span>
      <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span>
      <span class="s1">&#39;description_short&#39;</span><span class="p">:</span> <span class="s1">&#39;message_short&#39;</span><span class="p">,</span>
  <span class="p">}</span>

<div class="viewcode-block" id="PlasoExpression.Compile"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.PlasoExpression.Compile">[docs]</a>  <span class="k">def</span> <span class="nf">Compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_implementation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compiles the filter implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">      filter_implementation: a filter object (instance of objectfilter.TODO).</span>

<span class="sd">    Returns:</span>
<span class="sd">      A filter operator (instance of TODO).</span>

<span class="sd">    Raises:</span>
<span class="sd">      ParserError: if an unknown operator is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">swap_source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
    <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
    <span class="n">op_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">operator</span> <span class="o">=</span> <span class="n">filter_implementation</span><span class="o">.</span><span class="n">OPS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">op_str</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">operator</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(</span><span class="s1">u&#39;Unknown operator {0:s} provided.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">))</span>

    <span class="c1"># Plaso specific implementation - if we are comparing a timestamp</span>
    <span class="c1"># to a value, we use our specific implementation that compares</span>
    <span class="c1"># timestamps in a &quot;human readable&quot; format.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span>
      <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DateCompareObject</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">DateCompareObject</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Less&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">operator</span><span class="p">):</span>
          <span class="n">TimeRangeCache</span><span class="o">.</span><span class="n">SetUpperTimestamp</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">TimeRangeCache</span><span class="o">.</span><span class="n">SetLowerTimestamp</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
    <span class="n">expander</span> <span class="o">=</span> <span class="n">filter_implementation</span><span class="o">.</span><span class="n">FILTERS</span><span class="p">[</span><span class="s1">&#39;ValueExpander&#39;</span><span class="p">]</span>
    <span class="n">ops</span> <span class="o">=</span> <span class="n">operator</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span> <span class="n">value_expander</span><span class="o">=</span><span class="n">expander</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool_value</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span> <span class="s1">&#39;FlipBool&#39;</span><span class="p">):</span>
        <span class="n">ops</span><span class="o">.</span><span class="n">FlipBool</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ops</span></div></div>


<div class="viewcode-block" id="ParserList"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.ParserList">[docs]</a><span class="k">class</span> <span class="nc">ParserList</span><span class="p">(</span><span class="n">objectfilter</span><span class="o">.</span><span class="n">GenericBinaryOperator</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Matches when a parser is inside a predefined list of parsers.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">children</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct the parser list and retrieve a list of available parsers.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ParserList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">children</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">compiled_list</span> <span class="o">=</span> <span class="n">presets</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_operand</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">[])</span>

<div class="viewcode-block" id="ParserList.Operation"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.ParserList.Operation">[docs]</a>  <span class="k">def</span> <span class="nf">Operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">unused_y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a bool depending on the parser list contains the parser.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_operand</span> <span class="o">!=</span> <span class="s1">&#39;parser&#39;</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">objectfilter</span><span class="o">.</span><span class="n">MalformedQueryError</span><span class="p">(</span>
          <span class="s1">u&#39;Unable to use keyword &quot;inlist&quot; for other than parser.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiled_list</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">True</span>

    <span class="k">return</span> <span class="bp">False</span></div></div>


<div class="viewcode-block" id="PlasoAttributeFilterImplementation"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.PlasoAttributeFilterImplementation">[docs]</a><span class="k">class</span> <span class="nc">PlasoAttributeFilterImplementation</span><span class="p">(</span><span class="n">objectfilter</span><span class="o">.</span><span class="n">BaseFilterImplementation</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Does field name access on the lowercase version of names.</span>

<span class="sd">  Useful to only access attributes and properties with Google&#39;s python naming</span>
<span class="sd">  style.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">FILTERS</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">FILTERS</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">objectfilter</span><span class="o">.</span><span class="n">BaseFilterImplementation</span><span class="o">.</span><span class="n">FILTERS</span><span class="p">)</span>
  <span class="n">FILTERS</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;ValueExpander&#39;</span><span class="p">:</span> <span class="n">PlasoValueExpander</span><span class="p">})</span>
  <span class="n">OPS</span> <span class="o">=</span> <span class="n">objectfilter</span><span class="o">.</span><span class="n">OP2FN</span>
  <span class="n">OPS</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;inlist&#39;</span><span class="p">:</span> <span class="n">ParserList</span><span class="p">,})</span></div>


<div class="viewcode-block" id="DateCompareObject"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject">[docs]</a><span class="k">class</span> <span class="nc">DateCompareObject</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A specific class created for date comparison.</span>

<span class="sd">  This object takes a date representation, whether that is a direct integer</span>
<span class="sd">  datetime object or a string presenting the date, and uses that for comparing</span>
<span class="sd">  against timestamps stored in microseconds in in microseconds since</span>
<span class="sd">  Jan 1, 1970 00:00:00 UTC.</span>

<span class="sd">  This makes it possible to use regular comparison operators for date,</span>
<span class="sd">  irrelevant of the format the date comes in, since plaso stores all timestamps</span>
<span class="sd">  in the same format, which is an integer/long, it is a simple manner of</span>
<span class="sd">  changing the input into the same format (int) and compare that.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take a date object and use that for comparison.</span>

<span class="sd">    Args:</span>
<span class="sd">      data: A string, datetime object or an integer containing the number</span>
<span class="sd">            of micro seconds since January 1, 1970, 00:00:00 UTC.</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError: if the date string is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">py2to3</span><span class="o">.</span><span class="n">INTEGER_TYPES</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">u&#39;{0:d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">py2to3</span><span class="o">.</span><span class="n">LONG_TYPE</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">u&#39;{0:f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">py2to3</span><span class="o">.</span><span class="n">STRING_TYPES</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">GetUnicodeString</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">timelib</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">FromTimeString</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">TimestampError</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">u&#39;Wrongly formatted date string: {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">timelib</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">FromPythonDatetime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">u&#39;{0!s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DateCompareObject</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">u&#39;{0!s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">u&#39;Unsupported type: {0:s}.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

<div class="viewcode-block" id="DateCompareObject.__cmp__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject.__cmp__">[docs]</a>  <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A simple comparison operation.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">x_date</span> <span class="o">=</span> <span class="n">DateCompareObject</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="k">return</span> <span class="nb">cmp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">x_date</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="DateCompareObject.__le__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject.__le__">[docs]</a>  <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Less or equal comparison.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">x</span></div>

<div class="viewcode-block" id="DateCompareObject.__ge__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject.__ge__">[docs]</a>  <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Greater or equal comparison.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">x</span></div>

<div class="viewcode-block" id="DateCompareObject.__eq__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject.__eq__">[docs]</a>  <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if equal.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span></div>

<div class="viewcode-block" id="DateCompareObject.__ne__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject.__ne__">[docs]</a>  <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if not equal.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span></div>

<div class="viewcode-block" id="DateCompareObject.__str__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.DateCompareObject.__str__">[docs]</a>  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a string representation of the object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span></div></div>


<div class="viewcode-block" id="BaseParser"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.BaseParser">[docs]</a><span class="k">class</span> <span class="nc">BaseParser</span><span class="p">(</span><span class="n">objectfilter</span><span class="o">.</span><span class="n">Parser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Plaso version of the Parser.&quot;&quot;&quot;</span>

  <span class="n">expression_cls</span> <span class="o">=</span> <span class="n">PlasoExpression</span></div>


<div class="viewcode-block" id="TrueObject"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject">[docs]</a><span class="k">class</span> <span class="nc">TrueObject</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A simple object that always returns true for all comparison.</span>

<span class="sd">  This object is used for testing certain conditions inside filter queries.</span>
<span class="sd">  By returning true for all comparisons this object can be used to evaluate</span>
<span class="sd">  specific portions of a filter query.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save the text object so it can be used when comparing text.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span>

<div class="viewcode-block" id="TrueObject.__getattr__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__getattr__">[docs]</a>  <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_attr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a TrueObject for every attribute request.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="TrueObject.__eq__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__eq__">[docs]</a>  <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true for tests of equality.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="TrueObject.__gt__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__gt__">[docs]</a>  <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true for checks for greater.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="TrueObject.__ge__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__ge__">[docs]</a>  <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true for checks for greater or equal.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="TrueObject.__lt__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__lt__">[docs]</a>  <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true for checks of less.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="TrueObject.__le__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__le__">[docs]</a>  <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true for checks of less or equal.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="TrueObject.__ne__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__ne__">[docs]</a>  <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true for all not equal comparisons.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="TrueObject.__iter__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__iter__">[docs]</a>  <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a generator so a test for the in keyword can be used.&quot;&quot;&quot;</span>
    <span class="k">yield</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="TrueObject.__str__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TrueObject.__str__">[docs]</a>  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a string to make regular expression searches possible.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string that contains the original query with some of the matches</span>
<span class="sd">      expanded, perhaps several times.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Regular expressions in pfilter may include the following escapes:</span>
    <span class="c1">#     &quot;\\&#39;\&quot;rnbt\.ws&quot;:</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span>
    <span class="k">if</span> <span class="s1">r&#39;\.&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span>
      <span class="n">txt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">r&#39;\.&#39;</span><span class="p">,</span> <span class="s1">&#39; _ text _ &#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">r&#39;\b&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span>
      <span class="n">txt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">r&#39;\b&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">r&#39;\s&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span>
      <span class="n">txt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">r&#39;\s&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">txt</span></div></div>


<div class="viewcode-block" id="MockTestFilter"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.MockTestFilter">[docs]</a><span class="k">class</span> <span class="nc">MockTestFilter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A mock test filter object used to test certain portion of test queries.</span>

<span class="sd">  The logic behind this object is that a single attribute can be isolated</span>
<span class="sd">  for comparison. That is to say all calls to attributes will lead to a TRUE</span>
<span class="sd">  response, except those attributes that are specifically stated in the</span>
<span class="sd">  constructor. This way it is simple to test for instance whether or not</span>
<span class="sd">  to include a parser at all, before actually running the tool. The same applies</span>
<span class="sd">  to filtering out certain filenames, etc.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Constructor, only valid attribute is the parser one.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">txt</span> <span class="o">=</span> <span class="n">query</span>

<div class="viewcode-block" id="MockTestFilter.__getattr__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.MockTestFilter.__getattr__">[docs]</a>  <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return TrueObject for all requests except for stored attributes.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="c1"># TODO: Either delete this entire object (MockTestFilter) or implement</span>
    <span class="c1"># a false object and return the correct one depending on whether we</span>
    <span class="c1"># are looking for a true or negative response (eg &quot;not&quot; keyword included).</span>
    <span class="k">return</span> <span class="n">TrueObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TimeRangeCache"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TimeRangeCache">[docs]</a><span class="k">class</span> <span class="nc">TimeRangeCache</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A class that stores timeranges from filters.&quot;&quot;&quot;</span>

  <span class="n">MAX_INT64</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">64</span><span class="o">-</span><span class="mi">1</span>

  <span class="nd">@classmethod</span>
<div class="viewcode-block" id="TimeRangeCache.SetLowerTimestamp"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TimeRangeCache.SetLowerTimestamp">[docs]</a>  <span class="k">def</span> <span class="nf">SetLowerTimestamp</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets the lower bound timestamp.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s1">&#39;_lower&#39;</span><span class="p">):</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">_lower</span> <span class="o">=</span> <span class="n">timestamp</span>
      <span class="k">return</span>

    <span class="k">if</span> <span class="n">timestamp</span> <span class="o">&lt;</span> <span class="n">cls</span><span class="o">.</span><span class="n">_lower</span><span class="p">:</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">_lower</span> <span class="o">=</span> <span class="n">timestamp</span></div>

  <span class="nd">@classmethod</span>
<div class="viewcode-block" id="TimeRangeCache.SetUpperTimestamp"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TimeRangeCache.SetUpperTimestamp">[docs]</a>  <span class="k">def</span> <span class="nf">SetUpperTimestamp</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets the upper bound timestamp.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s1">&#39;_upper&#39;</span><span class="p">):</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">_upper</span> <span class="o">=</span> <span class="n">timestamp</span>
      <span class="k">return</span>

    <span class="k">if</span> <span class="n">timestamp</span> <span class="o">&gt;</span> <span class="n">cls</span><span class="o">.</span><span class="n">_upper</span><span class="p">:</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">_upper</span> <span class="o">=</span> <span class="n">timestamp</span></div>

  <span class="nd">@classmethod</span>
<div class="viewcode-block" id="TimeRangeCache.GetTimeRange"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.pfilter.TimeRangeCache.GetTimeRange">[docs]</a>  <span class="k">def</span> <span class="nf">GetTimeRange</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the first and last timestamp of filter range.&quot;&quot;&quot;</span>
    <span class="n">first</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s1">&#39;_lower&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">last</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="s1">&#39;_upper&#39;</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">MAX_INT64</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">first</span> <span class="o">&lt;</span> <span class="n">last</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">last</span><span class="p">,</span> <span class="n">first</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../plaso.html" >plaso</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright The Plaso Project Authors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.2.
    </div>
  </body>
</html>