<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plaso.lib.lexer &mdash; Plaso 1.4.1_20160603 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.4.1_20160603',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="Plaso 1.4.1_20160603 documentation" href="../../../index.html" />
    <link rel="up" title="plaso" href="../../plaso.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../plaso.html" accesskey="U">plaso</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for plaso.lib.lexer</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;An LL(1) lexer. This lexer is very tolerant of errors and can resync.</span>

<span class="sd">This lexer is originally copied from the GRR project:</span>
<span class="sd">https://code.google.com/p/grr</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">plaso.lib</span> <span class="kn">import</span> <span class="n">errors</span>


<div class="viewcode-block" id="Token"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Token">[docs]</a><span class="k">class</span> <span class="nc">Token</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A token action.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_regex</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the token object.</span>

<span class="sd">    Args:</span>

<span class="sd">      state_regex: If this regular expression matches the current state this</span>
<span class="sd">                   rule is considered.</span>
<span class="sd">      regex: A regular expression to try and match from the current point.</span>
<span class="sd">      actions: A command separated list of method names in the Lexer to call.</span>
<span class="sd">      next_state: The next state we transition to if this Token matches.</span>
<span class="sd">      flags: re flags.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">state_regex</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">U</span> <span class="o">|</span> <span class="n">flags</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">U</span> <span class="o">|</span> <span class="n">flags</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">re_str</span> <span class="o">=</span> <span class="n">regex</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">actions</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span> <span class="o">=</span> <span class="n">next_state</span></div>


<div class="viewcode-block" id="Lexer"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer">[docs]</a><span class="k">class</span> <span class="nc">Lexer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A generic feed lexer.&quot;&quot;&quot;</span>
  <span class="n">_CONTINUE_STATE</span> <span class="o">=</span> <span class="s1">&#39;CONTINUE&#39;</span>
  <span class="n">_INITIAL_STATE</span> <span class="o">=</span> <span class="s1">&#39;INITIAL&#39;</span>

  <span class="n">_ERROR_TOKEN</span> <span class="o">=</span> <span class="s1">&#39;Error&#39;</span>

  <span class="c1"># A list of Token() instances.</span>
  <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the lexer object.</span>

<span class="sd">    Args:</span>
<span class="sd">      data: optional initial data to be processed by the lexer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Lexer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_INITIAL_STATE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Lexer.NextToken"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.NextToken">[docs]</a>  <span class="k">def</span> <span class="nf">NextToken</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fetch the next token by trying to match any of the regexes in order.&quot;&quot;&quot;</span>
    <span class="n">current_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span>
      <span class="c1"># Does the rule apply to us?</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">state_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">current_state</span><span class="p">):</span>
        <span class="k">continue</span>

      <span class="c1"># Try to match the rule</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">continue</span>

      <span class="c1"># The match consumes the data off the buffer (the handler can put it back</span>
      <span class="c1"># if it likes)</span>
      <span class="c1"># TODO: using joins might be more efficient here.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[:</span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">():]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">processed</span> <span class="o">+=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>

      <span class="n">next_state</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">next_state</span>
      <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>

        <span class="c1"># Is there a callback to handle this action?</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Default</span><span class="p">)</span>

        <span class="c1"># Allow a callback to skip other callbacks.</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">possible_next_state</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">match</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">possible_next_state</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CONTINUE_STATE</span><span class="p">:</span>
            <span class="k">continue</span>
          <span class="c1"># Override the state from the Token</span>
          <span class="k">elif</span> <span class="n">possible_next_state</span><span class="p">:</span>
            <span class="n">next_state</span> <span class="o">=</span> <span class="n">possible_next_state</span>
        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">Error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>

      <span class="c1"># Update the next state</span>
      <span class="k">if</span> <span class="n">next_state</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">next_state</span>

      <span class="k">return</span> <span class="n">token</span>

    <span class="c1"># Check that we are making progress - if we are too full, we assume we are</span>
    <span class="c1"># stuck.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Error</span><span class="p">(</span><span class="s1">u&#39;Expected {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ERROR_TOKEN</span></div>

<div class="viewcode-block" id="Lexer.Close"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.Close">[docs]</a>  <span class="k">def</span> <span class="nf">Close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A convenience function to force us to parse all the data.&quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">NextToken</span><span class="p">():</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">:</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="Lexer.Default"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.Default">[docs]</a>  <span class="k">def</span> <span class="nf">Default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwarg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The default callback handler.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Default handler: {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwarg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Lexer.Empty"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.Empty">[docs]</a>  <span class="k">def</span> <span class="nf">Empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a boolean indicating if the buffer is empty.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span></div>

<div class="viewcode-block" id="Lexer.Error"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.Error">[docs]</a>  <span class="k">def</span> <span class="nf">Error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Log an error down.</span>

<span class="sd">    Args:</span>
<span class="sd">      message: optional error message.</span>
<span class="sd">      weight: optional error weight.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Error({0:d}): {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>
    <span class="c1"># Keep a count of errors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">+=</span> <span class="n">weight</span></div>

<div class="viewcode-block" id="Lexer.PushState"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.PushState">[docs]</a>  <span class="k">def</span> <span class="nf">PushState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Push the current state on the state stack.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Storing state {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span></div>

<div class="viewcode-block" id="Lexer.PopState"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.PopState">[docs]</a>  <span class="k">def</span> <span class="nf">PopState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pop the previous state from the stack.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
      <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Returned state to {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">))</span>

      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Error</span><span class="p">(</span>
          <span class="s1">u&#39;Tried to pop the state but failed - possible recursion error&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Lexer.Feed"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.Feed">[docs]</a>  <span class="k">def</span> <span class="nf">Feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Feed the buffer with data.</span>

<span class="sd">    Args:</span>
<span class="sd">      data: data to be processed by the lexer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">data</span><span class="p">])</span></div>

<div class="viewcode-block" id="Lexer.PushBack"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Lexer.PushBack">[docs]</a>  <span class="k">def</span> <span class="nf">PushBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Push the match back on the stream.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: optional data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)]</span></div></div>


<div class="viewcode-block" id="SelfFeederMixIn"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SelfFeederMixIn">[docs]</a><span class="k">class</span> <span class="nc">SelfFeederMixIn</span><span class="p">(</span><span class="n">Lexer</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;This mixin is used to make a lexer which feeds itself.</span>

<span class="sd">  Note that self.file_object must be the file object we read from.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># TODO: fix this, file object either needs to be set or not passed here.</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_object</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the lexer feeder min object.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_object: Optional file-like object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">SelfFeederMixIn</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_object</span> <span class="o">=</span> <span class="n">file_object</span>

<div class="viewcode-block" id="SelfFeederMixIn.Feed"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SelfFeederMixIn.Feed">[docs]</a>  <span class="k">def</span> <span class="nf">Feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">512</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Feed data into the buffer.</span>

<span class="sd">    Args:</span>
<span class="sd">      size: optional data size to read form the file-like object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_object</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">Lexer</span><span class="o">.</span><span class="n">Feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="SelfFeederMixIn.NextToken"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SelfFeederMixIn.NextToken">[docs]</a>  <span class="k">def</span> <span class="nf">NextToken</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieves the next token.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The next token (instance of Token) or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If we don&#39;t have enough data - feed ourselves: We assume</span>
    <span class="c1"># that we must have at least one sector in our buffer.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">512</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Feed</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">return</span> <span class="n">Lexer</span><span class="o">.</span><span class="n">NextToken</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Expression"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression">[docs]</a><span class="k">class</span> <span class="nc">Expression</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A class representing an expression.&quot;&quot;&quot;</span>
  <span class="n">attribute</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="n">args</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="n">operator</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="c1"># The expected number of args</span>
  <span class="n">number_of_args</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the expression object.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="Expression.__str__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression.__str__">[docs]</a>  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a string representation of the expression.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;Expression: ({0:s}) ({1:s}) {2:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Expression.AddArg"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression.AddArg">[docs]</a>  <span class="k">def</span> <span class="nf">AddArg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a new arg to this expression.</span>

<span class="sd">    Args:</span>
<span class="sd">       arg: The argument to add (string).</span>

<span class="sd">    Returns:</span>
<span class="sd">      True if this arg is the last arg, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">      ParseError: If there are too many args.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_args</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(</span><span class="s1">u&#39;Too many args for this expression.&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_args</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">True</span>

    <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="Expression.Compile"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression.Compile">[docs]</a>  <span class="k">def</span> <span class="nf">Compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_filter_implementation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a filter implementation, compile this expression.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s1">u&#39;{0:s} does not implement Compile.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span></div>

  <span class="c1"># TODO: rename this function to GetTreeAsString or equivalent.</span>
<div class="viewcode-block" id="Expression.PrintTree"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression.PrintTree">[docs]</a>  <span class="k">def</span> <span class="nf">PrintTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print the tree.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">u&#39;{0:s} {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Expression.SetAttribute"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression.SetAttribute">[docs]</a>  <span class="k">def</span> <span class="nf">SetAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the attribute.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute</span></div>

<div class="viewcode-block" id="Expression.SetOperator"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.Expression.SetOperator">[docs]</a>  <span class="k">def</span> <span class="nf">SetOperator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the operator.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="n">operator</span></div></div>


<div class="viewcode-block" id="BinaryExpression"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.BinaryExpression">[docs]</a><span class="k">class</span> <span class="nc">BinaryExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;An expression which takes two other expressions.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the expression object.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="n">operator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">part</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">BinaryExpression</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="BinaryExpression.__str__"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.BinaryExpression.__str__">[docs]</a>  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a string representation of the binary expression.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;Binary Expression: {0:s} {1:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">])</span></div>

<div class="viewcode-block" id="BinaryExpression.AddOperands"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.BinaryExpression.AddOperands">[docs]</a>  <span class="k">def</span> <span class="nf">AddOperands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add an operand.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(</span>
          <span class="s1">u&#39;Expected expression, got {0:s} {1:s} {2:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
              <span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">,</span> <span class="n">rhs</span><span class="p">))</span></div>

  <span class="c1"># TODO: rename this function to GetTreeAsString or equivalent.</span>
<div class="viewcode-block" id="BinaryExpression.PrintTree"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.BinaryExpression.PrintTree">[docs]</a>  <span class="k">def</span> <span class="nf">PrintTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print the tree.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s1">u&#39;{0:s}{1:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
      <span class="n">result</span> <span class="o">+=</span> <span class="s1">u&#39;{0:s}-{1:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">PrintTree</span><span class="p">(</span><span class="n">depth</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="BinaryExpression.Compile"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.BinaryExpression.Compile">[docs]</a>  <span class="k">def</span> <span class="nf">Compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_implementation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compile the binary expression into a filter object.&quot;&quot;&quot;</span>
    <span class="n">operator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;and&#39;</span> <span class="ow">or</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">:</span>
      <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;AndFilter&#39;</span>
    <span class="k">elif</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;or&#39;</span> <span class="ow">or</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;||&#39;</span><span class="p">:</span>
      <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;OrFilter&#39;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(</span>
          <span class="s1">u&#39;Invalid binary operator {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">operator</span><span class="p">))</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">Compile</span><span class="p">(</span><span class="n">filter_implementation</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">filter_implementation</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="IdentityExpression"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.IdentityExpression">[docs]</a><span class="k">class</span> <span class="nc">IdentityExpression</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;An Expression which always evaluates to True.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="IdentityExpression.Compile"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.IdentityExpression.Compile">[docs]</a>  <span class="k">def</span> <span class="nf">Compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_implementation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compile the expression.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">filter_implementation</span><span class="o">.</span><span class="n">IdentityFilter</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="SearchParser"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser">[docs]</a><span class="k">class</span> <span class="nc">SearchParser</span><span class="p">(</span><span class="n">Lexer</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;This parser can parse the mini query language and build an AST.</span>

<span class="sd">  Examples of valid syntax:</span>
<span class="sd">    filename contains &quot;foo&quot; and (size &gt; 100k or date before &quot;2011-10&quot;)</span>
<span class="sd">    date between 2011 and 2010</span>
<span class="sd">    files older than 1 year</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">expression_cls</span> <span class="o">=</span> <span class="n">Expression</span>
  <span class="n">binary_expression_cls</span> <span class="o">=</span> <span class="n">BinaryExpression</span>

  <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span>
      <span class="c1"># Double quoted string</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;STRING&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;PopState,StringFinish&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;STRING&#39;</span><span class="p">,</span> <span class="s1">r&#39;</span><span class="se">\\</span><span class="s1">(.)&#39;</span><span class="p">,</span> <span class="s1">&#39;StringEscape&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;STRING&#39;</span><span class="p">,</span> <span class="s1">r&#39;[^</span><span class="se">\\</span><span class="s1">&quot;]+&#39;</span><span class="p">,</span> <span class="s1">&#39;StringInsert&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>

      <span class="c1"># Single quoted string</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;SQ_STRING&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;PopState,StringFinish&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;SQ_STRING&#39;</span><span class="p">,</span> <span class="s1">r&#39;</span><span class="se">\\</span><span class="s1">(.)&#39;</span><span class="p">,</span> <span class="s1">&#39;StringEscape&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;SQ_STRING&#39;</span><span class="p">,</span> <span class="s1">r&#39;[^</span><span class="se">\\\&#39;</span><span class="s1">]+&#39;</span><span class="p">,</span> <span class="s1">&#39;StringInsert&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>

      <span class="c1"># TODO: Implement a unary not operator.</span>
      <span class="c1"># The first thing we see in the initial state takes up to the ATTRIBUTE</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;INITIAL&#39;</span><span class="p">,</span> <span class="s1">r&#39;(and|or|\&amp;\&amp;|\|\|)&#39;</span><span class="p">,</span> <span class="s1">&#39;BinaryOperator&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;INITIAL&#39;</span><span class="p">,</span> <span class="s1">r&#39;[^\s\(\)]&#39;</span><span class="p">,</span> <span class="s1">&#39;PushState,PushBack&#39;</span><span class="p">,</span> <span class="s1">&#39;ATTRIBUTE&#39;</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;INITIAL&#39;</span><span class="p">,</span> <span class="s1">r&#39;\(&#39;</span><span class="p">,</span> <span class="s1">&#39;BracketOpen&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;INITIAL&#39;</span><span class="p">,</span> <span class="s1">r&#39;\)&#39;</span><span class="p">,</span> <span class="s1">&#39;BracketClose&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>

      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;ATTRIBUTE&#39;</span><span class="p">,</span> <span class="s1">r&#39;[\w._0-9]+&#39;</span><span class="p">,</span> <span class="s1">&#39;StoreAttribute&#39;</span><span class="p">,</span> <span class="s1">&#39;OPERATOR&#39;</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;OPERATOR&#39;</span><span class="p">,</span> <span class="s1">r&#39;[a-z0-9&lt;&gt;=\-\+\!\^\&amp;%]+&#39;</span><span class="p">,</span> <span class="s1">&#39;StoreOperator&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ARG_LIST&#39;</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;OPERATOR&#39;</span><span class="p">,</span> <span class="s1">r&#39;(!=|[&lt;&gt;=])&#39;</span><span class="p">,</span> <span class="s1">&#39;StoreSpecialOperator&#39;</span><span class="p">,</span> <span class="s1">&#39;ARG_LIST&#39;</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;ARG_LIST&#39;</span><span class="p">,</span> <span class="s1">r&#39;[^\s</span><span class="se">\&#39;</span><span class="s1">&quot;]+&#39;</span><span class="p">,</span> <span class="s1">&#39;InsertArg&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>

      <span class="c1"># Start a string.</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;PushState,StringStart&#39;</span><span class="p">,</span> <span class="s1">&#39;STRING&#39;</span><span class="p">),</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;PushState,StringStart&#39;</span><span class="p">,</span> <span class="s1">&#39;SQ_STRING&#39;</span><span class="p">),</span>

      <span class="c1"># Skip whitespace.</span>
      <span class="n">Token</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">r&#39;\s+&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
      <span class="p">]</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes the search parser object.&quot;&quot;&quot;</span>
    <span class="c1"># Holds expression</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_cls</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="n">data</span>
    <span class="c1"># The token stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">Lexer</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="SearchParser.BinaryOperator"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.BinaryOperator">[docs]</a>  <span class="k">def</span> <span class="nf">BinaryOperator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the binary operator.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binary_expression_cls</span><span class="p">(</span><span class="n">string</span><span class="p">))</span></div>

<div class="viewcode-block" id="SearchParser.BracketOpen"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.BracketOpen">[docs]</a>  <span class="k">def</span> <span class="nf">BracketOpen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Define an open bracket.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SearchParser.BracketClose"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.BracketClose">[docs]</a>  <span class="k">def</span> <span class="nf">BracketClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Close the bracket.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SearchParser.StringStart"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.StringStart">[docs]</a>  <span class="k">def</span> <span class="nf">StringStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the string.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="SearchParser.StringEscape"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.StringEscape">[docs]</a>  <span class="k">def</span> <span class="nf">StringEscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Escape backslashes found inside a string quote.</span>

<span class="sd">    Backslashes followed by anything other than [&#39;&quot;rnbt] will just be included</span>
<span class="sd">    in the string.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: The string that matched.</span>
<span class="sd">      match: the match object (instance of re.MatchObject).</span>
<span class="sd">             Where match.group(1) contains the escaped code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;rnbt&#39;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">+=</span> <span class="n">string</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;string_escape&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">+=</span> <span class="n">string</span></div>

<div class="viewcode-block" id="SearchParser.StringInsert"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.StringInsert">[docs]</a>  <span class="k">def</span> <span class="nf">StringInsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add to the string.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">string</span> <span class="o">+=</span> <span class="n">string</span></div>

<div class="viewcode-block" id="SearchParser.StringFinish"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.StringFinish">[docs]</a>  <span class="k">def</span> <span class="nf">StringFinish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finish the string operation.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;ATTRIBUTE&#39;</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">StoreAttribute</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;ARG_LIST&#39;</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">InsertArg</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">)</span></div>

<div class="viewcode-block" id="SearchParser.StoreAttribute"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.StoreAttribute">[docs]</a>  <span class="k">def</span> <span class="nf">StoreAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store the attribute.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Storing attribute {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">string</span><span class="p">)))</span>

    <span class="c1"># TODO: Update the expected number_of_args</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">current_expression</span><span class="o">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(</span><span class="s1">u&#39;Invalid attribute </span><span class="se">\&#39;</span><span class="s1">{0:s}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

    <span class="k">return</span> <span class="s1">&#39;OPERATOR&#39;</span></div>

<div class="viewcode-block" id="SearchParser.StoreOperator"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.StoreOperator">[docs]</a>  <span class="k">def</span> <span class="nf">StoreOperator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store the operator.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Storing operator {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">string</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_expression</span><span class="o">.</span><span class="n">SetOperator</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></div>

<div class="viewcode-block" id="SearchParser.InsertArg"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.InsertArg">[docs]</a>  <span class="k">def</span> <span class="nf">InsertArg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">unused_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Insert an arg to the current expression.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">u&#39;Storing Argument {0:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

    <span class="c1"># This expression is complete</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_expression</span><span class="o">.</span><span class="n">AddArg</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_expression</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">current_expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_cls</span><span class="p">()</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PopState</span><span class="p">()</span></div>

  <span class="k">def</span> <span class="nf">_CombineBinaryExpressions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine binary expressions.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">BinaryExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">operator</span> <span class="o">==</span> <span class="n">operator</span> <span class="ow">and</span>
          <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Expression</span><span class="p">)</span> <span class="ow">and</span>
          <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">Expression</span><span class="p">)):</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">AddOperands</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_CombineParenthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine parenthesis.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
      <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span>
          <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">Expression</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>

<div class="viewcode-block" id="SearchParser.Reduce"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.Reduce">[docs]</a>  <span class="k">def</span> <span class="nf">Reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reduce the token stack into an AST.&quot;&quot;&quot;</span>
    <span class="c1"># Check for sanity</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="s1">&#39;INITIAL&#39;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Error</span><span class="p">(</span><span class="s1">u&#39;Premature end of expression&#39;</span><span class="p">)</span>

    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="c1"># Precedence order</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_CombineParenthesis</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_CombineBinaryExpressions</span><span class="p">(</span><span class="s1">&#39;and&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_CombineBinaryExpressions</span><span class="p">(</span><span class="s1">&#39;or&#39;</span><span class="p">)</span>

      <span class="c1"># No change</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span> <span class="o">==</span> <span class="n">length</span><span class="p">:</span>
        <span class="k">break</span>
      <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">length</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Error</span><span class="p">(</span><span class="s1">u&#39;Illegal query expression&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="SearchParser.Error"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.Error">[docs]</a>  <span class="k">def</span> <span class="nf">Error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unused_weight</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Raise an error message.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParseError</span><span class="p">(</span>
        <span class="s1">u&#39;{0:s} in position {1:s}: {2:s} &lt;----&gt; {3:s} )&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">message</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">processed_buffer</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span></div>

<div class="viewcode-block" id="SearchParser.Parse"><a class="viewcode-back" href="../../../plaso.lib.html#plaso.lib.lexer.SearchParser.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">IdentityExpression</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Reduce</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plaso 1.4.1_20160603 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../plaso.html" >plaso</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright The Plaso Project Authors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.2.
    </div>
  </body>
</html>