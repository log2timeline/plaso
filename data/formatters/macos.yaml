# Mac-OS related event formatters.

type: 'conditional'
data_type: 'imessage:event:chat'
enumeration_helpers:
- input_attribute: 'message_type'
  output_attribute: 'message_type'
  default_value: 'UNKNOWN'
  values:
    0: 'Received'
    1: 'Sent'
- input_attribute: 'read_receipt'
  output_attribute: 'read_receipt'
  default_value: 'UNKNOWN'
  values:
    0: 'False'
    1: 'True'
message:
- 'Row ID: {identifier}'
- 'iMessage ID: {imessage_id}'
- 'Read Receipt: {read_receipt}'
- 'Message Type: {message_type}'
- 'Service: {service}'
- 'Attachment Location: {attachment_location}'
- 'Message Content: {text}'
short_message:
- '{text}'
short_source: 'iMessage'
source: 'Apple iMessage Application'
---
type: 'conditional'
data_type: 'ipod:device:entry'
message:
- 'Device ID: {device_id}'
- 'Type: {device_class}'
- '[{family_id}]'
- 'Connected {use_count} times'
- 'Serial nr: {serial_number}'
- 'IMEI [{imei}]'
short_message:
- 'Device ID: {device_id}'
- 'Type: {device_class}'
- '[{family_id}]'
- 'Connected {use_count} times'
- 'Serial nr: {serial_number}'
- 'IMEI [{imei}]'
short_source: 'LOG'
source: 'iPod Connections'
---
type: 'conditional'
data_type: 'mac:appfirewall:line'
message:
- 'Computer: {computer_name}'
- 'Agent: {agent}'
- 'Status: {status}'
- 'Process name: {process_name}'
- 'Log: {action}'
short_message:
- 'Process name: {process_name}'
- 'Status: {status}'
short_source: 'LOG'
source: 'Mac AppFirewall Log'
---
type: 'basic'
data_type: 'macosx:application_usage'
message: '{application} v.{app_version} (bundle: {bundle_id}). Launched: {count} time(s)'
short_message: '{application} ({count} time(s))'
short_source: 'LOG'
source: 'Application Usage'
---
type: 'conditional'
data_type: 'mac:document_versions:file'
message:
- 'Version of [{name}]'
- '({path})'
- 'stored in {version_path}'
- 'by {user_sid}'
short_message:
- 'Stored a document version of [{name}]'
short_source: 'HISTORY'
source: 'Document Versions'
---
type: 'conditional'
data_type: 'mac:keychain:application'
message:
- 'Name: {entry_name}'
- 'Account: {account_name}'
short_message:
- '{entry_name}'
short_source: 'LOG'
source: 'Keychain Application password'
---
type: 'conditional'
data_type: 'mac:keychain:internet'
message:
- 'Name: {entry_name}'
- 'Account: {account_name}'
- 'Where: {where}'
- 'Protocol: {protocol}'
- '({type_protocol})'
short_message:
- '{entry_name}'
short_source: 'LOG'
source: 'Keychain Internet password'
---
type: 'conditional'
data_type: 'mac:knowledgec:application'
message:
- 'Application {bundle_identifier} executed'
- 'for {duration} seconds'
short_message:
- 'Application {bundle_identifier}'
short_source: 'LOG'
source: 'KnowledgeC Application'
---
type: 'conditional'
data_type: 'mac:knowledgec:safari'
message:
- 'Visited: {url}'
- '({title})'
- 'Duration: {duration}'
short_message:
- 'Safari: {url}'
short_source: 'WEBHIST'
source: 'KnowledgeC Safari'
---
type: 'conditional'
data_type: 'macosx:lsquarantine'
message:
- '[{agent}]'
- 'Downloaded: {url}'
- '<{data}>'
short_message:
- '{url}'
short_source: 'LOG'
source: 'LS Quarantine Event'
---
type: 'conditional'
data_type: 'mac:notes:note'
message:
- 'title:{title}'
- 'note_text:{text}'
short_message:
- 'title:{title}'
short_source: 'Mac Note'
source: 'Mac Notes'
---
type: 'conditional'
data_type: 'mac:notificationcenter:db'
enumeration_helpers:
- input_attribute: 'presented'
  output_attribute: 'presented'
  default_value: 'UNKNOWN'
  values:
    0: 'No'
    1: 'Yes'
message:
- 'Title: {title}'
- '(, subtitle: {subtitle}),'
- 'registered by: {bundle_name}.'
- 'Presented: {presented},'
- 'Content: {body}'
short_message:
- 'Title: {title},'
- 'Content: {body}'
short_source: 'NOTIFICATION'
source: 'Notification Center'
---
type: 'conditional'
data_type: 'mac:securityd:line'
message:
- 'Sender: {sender}'
- '({sender_pid})'
- 'Level: {level}'
- 'Facility: {facility}'
- 'Text: {message}'
short_message:
- 'Text: {message}'
short_source: 'LOG'
source: 'Mac Securityd Log'
---
type: 'conditional'
data_type: 'mac:wifilog:line'
message:
- 'Action: {action}'
- 'Agent: {agent}'
- '({function})'
- 'Log: {text}'
short_message:
- 'Action: {action}'
short_source: 'LOG'
source: 'Mac Wifi Log'
---
type: 'conditional'
data_type: 'mackeeper:cache'
message:
- '{description}'
- '<{event_type}>'
- ':'
- '{text}'
- '['
- 'URL: {url}'
- 'Event ID: {record_id}'
- 'Room: {room}'
- ']'
short_message:
- '<{event_type}>'
- '{text}'
short_source: 'LOG'
source: 'MacKeeper Cache'
---
type: 'conditional'
data_type: 'plist:key'
message:
- '{root}/'
- '{key}'
- ' {desc}'
separator: ''
short_message:
- '{root}/'
- '{key}'
- ' {desc}'
short_source: 'PLIST'
source: 'Plist Entry'
---
type: 'conditional'
data_type: 'mac:utmpx:event'
enumeration_helpers:
- input_attribute: 'type'
  output_attribute: 'status'
  default_value: 'UNKNOWN'
  values:
    0: 'EMPTY'
    1: 'RUN_LVL'
    2: 'BOOT_TIME'
    3: 'OLD_TIME'
    4: 'NEW_TIME'
    5: 'INIT_PROCESS'
    6: 'LOGIN_PROCESS'
    7: 'USER_PROCESS'
    8: 'DEAD_PROCESS'
    9: 'ACCOUNTING'
    10: 'SIGNATURE'
    11: 'SHUTDOWN_TIME'
message:
- 'User: {username}'
- 'Status: {status}'
- 'Hostname: {hostname}'
- 'Terminal: {terminal}'
- 'PID: {pid}'
- 'Terminal identifier: {terminal_identifier}'
short_message:
- 'User: {username}'
- 'PID: {pid}'
- 'Status: {status}'
short_source: 'LOG'
source: 'UTMPX session'
---
type: 'conditional'
data_type: 'macos:tcc_entry'
enumeration_helpers:
- input_attribute: 'allowed'
  output_attribute: 'allowed'
  default_value: 'UNKNOWN'
  values:
    0: 'False'
    1: 'True'
message:
- 'Service: {service}'
- 'Client: {client}'
- 'Allowed: {allowed}'
- 'Prompt count: {prompt_count}'
short_message:
- '{service}:'
- '{client}'
short_source: 'macOS TCC'
source: 'macOS Transparenty, Control and Consent logs'
---
type: 'conditional'
data_type: 'spotlight:metadata_item'
message:
- '{file_name}'
- '{content_type}'
short_message:
- '{file_name}'
short_source: 'SPOTLIGHT'
source: 'Spotlight store database'
