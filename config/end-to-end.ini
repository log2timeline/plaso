[analyze_and_output1]
case=analyze_and_output
analysis_options=--analysis unique_domains_visited
output_file=analyze_and_output1.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/dynamic.log
source=test_data/psort_test.plaso
source_options=backup

[extract_and_analyze1]
case=extract_and_analyze
analysis_options=--analysis unique_domains_visited --worker-timeout 1.0
output_file=extract_and_analyze1.log
output_format=dynamic
output_options=--dynamic-time
source=test_data/vsstest.qcow2

[extract_and_output1]
case=extract_and_output
extract_options=--vss_stores=none
output_file=extract_and_output1.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output.log
source=test_data/vsstest.qcow2

[extract_and_output2]
case=extract_and_output
extract_options=--vss_stores=none
output_file=extract_and_output2.log
output_format=dynamic
output_options=--additional-fields=myfield --dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_with_additional_fields.log
source=test_data/vsstest.qcow2

[extract_and_output3]
case=extract_and_output
extract_options=--vss_stores=none
output_file=extract_and_output3.log
output_format=dynamic
output_options=--custom-fields=custom:MyField --dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_with_custom_fields.log
source=test_data/vsstest.qcow2

[extract_and_output4]
case=extract_and_output_with_psteal
extract_options=--vss_stores=none
output_file=extract_and_output4.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output.log
source=test_data/vsstest.qcow2

[extract_and_output5]
case=extract_and_output
extract_options=--vss_stores=none
output_file=extract_and_output5.log
output_format=dynamic
output_options=--dynamic-time
custom_formatter_file=test_data/custom_formatters.yaml
reference_output_file=test_data/end_to_end/extract_and_output_with_custom_formatter.log
source=test_data/vsstest.qcow2

[extract_and_output_empty]
case=extract_and_output
extract_options=--parsers=bodyfile --vss_stores=none
output_file=extract_and_output_empty.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_empty.log
source=test_data/vsstest.qcow2

[extract_and_output_archive1]
case=extract_and_output
output_file=extract_and_output_archive1.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_archive1.log
source=test_data/syslog.tgz

[extract_and_output_archive2]
case=extract_and_output
output_file=extract_and_output_archive2.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_archive2.log
source=test_data/syslog.zip

[extract_and_output_no_hashers1]
case=extract_and_output
extract_options=--hashers=none --vss_stores=none
output_file=extract_and_output_no_hashers1.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output.log
source=test_data/vsstest.qcow2

[extract_and_output_with_filter_file2]
case=extract_and_output
filter_file=test_data/end_to_end/filter_file2.yaml
output_file=extract_and_output_with_filter_file2.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_with_filter_file2.log
source=test_data/ext4_with_binaries.dd

[extract_and_output_with_filter_file3]
case=extract_and_output
filter_file=test_data/end_to_end/filter_file3.yaml
output_file=extract_and_output_with_filter_file3.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_with_filter_file3.log
source=test_data/ext4_with_binaries.dd

[extract_and_output_with_parsers1]
case=extract_and_output
extract_options=--parsers mft
output_file=extract_and_output_with_parsers1.log
output_format=dynamic
output_options=--dynamic-time
reference_output_file=test_data/end_to_end/extract_and_output_with_parsers1.log
source=test_data/vsstest.qcow2

[extract_and_output_with_yara_rules]
case=extract_and_output
extract_options=--hashers md5
output_file=extract_and_output_with_yara_rules.log
output_format=dynamic
output_options=--dynamic-time --fields datetime,timestamp_desc,source,source_long,message,parser,md5_hash,yara_match
reference_output_file=test_data/end_to_end/extract_and_output_with_yara_rules.log
source=test_data/ext4_with_binaries.dd
yara_rules=test_data/end_to_end/rules.yara

[extract_and_output_with_time_zone]
case=extract_and_output
extract_options=--parsers !filestat -z CET --preferred-year 2020
output_file=extract_and_output_with_time_zone.log
output_format=dynamic
output_options=--dynamic-time --fields datetime,timestamp_desc,source,source_long,message,parser,tag
reference_output_file=test_data/end_to_end/extract_and_output_with_time_zone.log
source=test_data/syslog/syslog_rsyslog_traditional

[extract_and_output_without_time_zone]
case=extract_and_output
extract_options=--parsers !filestat --preferred-year 2020
output_file=extract_and_output_without_time_zone.log
output_format=dynamic
output_options=--dynamic-time --fields datetime,timestamp_desc,source,source_long,message,parser,tag
reference_output_file=test_data/end_to_end/extract_and_output_without_time_zone.log
source=test_data/syslog/syslog_rsyslog_traditional

[extract_and_output_with_winevt_rc]
case=extract_and_output
extract_options=--parsers winevtx
output_file=extract_and_output_with_winevt_rc.log
output_format=dynamic
output_options=--dynamic-time --fields datetime,timestamp_desc,source,source_long,message,parser,tag
reference_output_file=test_data/end_to_end/extract_and_output_with_winevt_rc.log
source=test_data/System.evtx

[extract_and_output_with_winevt_rc2]
case=extract_and_output
extract_options=--parsers winevtx
output_file=extract_and_output_with_winevt_rc2.log
output_format=dynamic
output_options=--dynamic-time --fields datetime,timestamp_desc,source,source_long,message,parser,tag
reference_output_file=test_data/end_to_end/extract_and_output_with_winevt_rc2.log
source=test_data/System2.evtx